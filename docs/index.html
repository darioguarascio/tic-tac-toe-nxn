<!DOCTYPE html><html> <head><title>Tic-Tac-Toe NxN w/ Machine Learning</title><meta charset="utf-8"><meta name="description"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, interactive-widget=resizes-content"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.14.8/dist/cdn.min.js"></script><script src="https://cdn.canvasjs.com/canvasjs.min.js"></script><style>*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%;margin-right:auto;margin-left:auto}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.visible{visibility:visible}.relative{position:relative}.mx-auto{margin-left:auto;margin-right:auto}.mb-2{margin-bottom:.5rem}.mb-4{margin-bottom:1rem}.ms-2{margin-inline-start:.5rem}.mt-10{margin-top:2.5rem}.mt-4{margin-top:1rem}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.size-1{width:.25rem;height:.25rem}.size-20{width:5rem;height:5rem}.h-12{height:3rem}.h-4{height:1rem}.h-6{height:1.5rem}.h-8{height:2rem}.w-14{width:3.5rem}.w-4{width:1rem}.w-6{width:1.5rem}.w-full{width:100%}.max-w-xs{max-width:20rem}.cursor-pointer{cursor:pointer}.appearance-none{-webkit-appearance:none;-moz-appearance:none;appearance:none}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.grid-cols-6{grid-template-columns:repeat(6,minmax(0,1fr))}.grid-cols-7{grid-template-columns:repeat(7,minmax(0,1fr))}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-center{justify-content:center}.justify-items-center{justify-items:center}.gap-3{gap:.75rem}.gap-x-12{-moz-column-gap:3rem;column-gap:3rem}.gap-x-3{-moz-column-gap:.75rem;column-gap:.75rem}.gap-x-6{-moz-column-gap:1.5rem;column-gap:1.5rem}.gap-y-12{row-gap:3rem}.gap-y-4{row-gap:1rem}.overflow-hidden{overflow:hidden}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.border{border-width:1px}.border-gray-300{--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.bg-gray-100{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.bg-gray-200{--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.bg-green-100{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-slate-400{--tw-bg-opacity: 1;background-color:rgb(148 163 184 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.p-1{padding:.25rem}.p-4{padding:1rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-8{padding-left:2rem;padding-right:2rem}.py-12{padding-top:3rem;padding-bottom:3rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-20{padding-top:5rem;padding-bottom:5rem}.pb-8{padding-bottom:2rem}.pt-6{padding-top:1.5rem}.text-center{text-align:center}.text-5xl{font-size:3rem;line-height:1}.text-7xl{font-size:4.5rem;line-height:1}.text-base{font-size:1rem;line-height:1.5rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.italic{font-style:italic}.leading-tight{line-height:1.25}.tracking-widest{letter-spacing:.1em}.text-blue-500{--tw-text-opacity: 1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity: 1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.duration-200{transition-duration:.2s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.before\:absolute:before{content:var(--tw-content);position:absolute}.before\:inset-0:before{content:var(--tw-content);inset:0}.before\:rounded-full:before{content:var(--tw-content);border-radius:9999px}.before\:bg-teal-500:before{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgb(20 184 166 / var(--tw-bg-opacity, 1))}.before\:transition:before{content:var(--tw-content);transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.before\:duration-300:before{content:var(--tw-content);transition-duration:.3s}.hover\:before\:scale-105:hover:before{content:var(--tw-content);--tw-scale-x: 1.05;--tw-scale-y: 1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus-visible\:ring:focus-visible{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus-visible\:ring-purple-400:focus-visible{--tw-ring-opacity: 1;--tw-ring-color: rgb(192 132 252 / var(--tw-ring-opacity, 1))}.active\:duration-75:active{transition-duration:75ms}.active\:before\:scale-95:active:before{content:var(--tw-content);--tw-scale-x: .95;--tw-scale-y: .95;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.aria-checked\:bg-blue-400[aria-checked=true]{--tw-bg-opacity: 1;background-color:rgb(96 165 250 / var(--tw-bg-opacity, 1))}.group[aria-checked=true] .group-aria-checked\:translate-x-full{--tw-translate-x: 100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@media (min-width: 768px){.md\:flex-row{flex-direction:row}}#grid{margin-left:auto;margin-right:auto;display:grid;justify-items:center;gap:.75rem;--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.cell{display:flex;width:5rem;height:5rem;cursor:pointer;align-items:center;justify-content:center;--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.cell.winner{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.cell.draw{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.cell-played{font-size:3rem;line-height:1;font-weight:700}.cell-content-0{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.cell-content-1{--tw-text-opacity: 1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}#moves>canvas:first-child{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}#moves div{align-items:center;justify-content:center;text-align:center}
</style></head> <body>  <section class="container"> <h1 class="text-center text-7xl font-bold text-gray-600 uppercase tracking-widest py-12">MENACE</h1> <h2 class="text-center text-xl text-gray-400 italic ">Matchbox Educable Noughts and Crosses Engine</h2> </section> <div class="container flex justify-center mt-10"> <div x-data="{ visible: true, size: 3, strike: 3 }" class="w-full max-w-xs" x-show="visible"> <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 flex flex-col gap-y-4"> <!-- <input type="hidden" name="size" value="3"> --> <div class="mb-4"> <label class="block text-gray-700 text-sm font-bold mb-2" for="grid-size">
Grid size
</label> <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="grid-size" type="number" placeholder="IE: 3" value="3" name="size" x-model="size"> </div> <div class="mb-4"> <label class="block text-gray-700 text-sm font-bold mb-2" for="grid-size">
Winning strike
</label> <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="winning-strike" type="number" placeholder="IE: 3" value="3" name="strike" x-model="strike"> </div> <!--         <div class="mb-4">
          <label class="block text-gray-700 text-sm font-bold mb-2" for="first-player">
            Who starts
          </label>

          <div class="flex items-center mb-4">
              <input checked="checked" id="first-player-human" type="radio" value="human" name="first-player" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300">
              <label for="first-player-human" class="ms-2 text-sm font-medium">Human</label>
          </div>
          <div class="flex items-center">
              <input id="first-player-machine" type="radio" value="machine" name="first-player" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300">
              <label for="first-player-machine" class="ms-2 text-sm font-medium">Machine</label>
          </div>

        </div>
 --> <div class="flex items-center justify-center"> <button @click="visible = false; $dispatch('newgame', [size,strike])" class="relative flex h-12 items-center justify-center px-8
          before:absolute before:inset-0 before:rounded-full before:bg-teal-500 before:transition
          before:duration-300 hover:before:scale-105 active:duration-75 active:before:scale-95
          "> <span class="relative text-base font-semibold text-white dark:text-dark">New Game</span> </button> </div> </div> </div> </div> <div id="menace" class="container mt-10" x-show="visible" x-data="menace" x-cloak @newgame.window="visible = true; reset($event)" @gamemsg.window="game($event)"> <h3 class="justify-center flex flex-row gap-x-6"> <span><strong class="font-bold text-red-500">O</strong> Player: <span x-text="stats.player"></span></span> <span><strong class="font-bold text-blue-500">X</strong> Machine: <span x-text="stats.machine"></span></span> <span>Draws: <span x-text="stats.draws"></span></span> </h3> <div class="flex flex-row justify-center"> <div class="flex flex-col gap-y-4 mt-10"> <button @click="toggle($el)" id="toggle-switch" type="button" role="switch" :aria-checked="train" class="group flex w-14 h-8 p-1 rounded-full bg-slate-400 transition-colors duration-200 ease-in-out overflow-hidden outline-none focus-visible:ring focus-visible:ring-purple-400 aria-checked:bg-blue-400"> <span class="w-6 h-6 rounded-full bg-white transition-transform duration-200 ease-in-out group-aria-checked:translate-x-full"></span> </button> <label id="toggle-switch-label" for="toggle-switch">
Autoplay (random)
</label> </div> </div> <div class="mt-10 flex flex-col md:flex-row justify-center items-start gap-x-12"> <div> <div class="border rounded-lg shadow-lg p-4 mt-4"> <div x-ref="grid" id="grid" :class="'grid-cols-' + size" :style="'width: ' + ((20 * 4 * size) + (12 * (size-1))) + 'px'"> <template x-for="i in size*size"> <div class="cell" data-empty="1" :data-cell="i" :id="'cell-' + (i-1)" @click="move(i)"></div> </template> </div> </div> </div> <div class="hidden"> <h3 class="">Moves and scores</h3> <div id="moves" x-ref="moves" class="grid grid-cols-2 gap-y-12 gap-x-3 mt-4"></div> </div> </div> <!-- <button @click="paintRow(1)">paint</button> --> </div> <script type="module">window.gameWorker=new Worker(new URL("/tic-tac-toe-nxn/_astro/worker-FCOjfZZ4.js",import.meta.url),{type:"module"});window.gameWorker.onmessage=e=>{window.dispatchEvent(new CustomEvent("gamemsg",{detail:e.data}))};
//# sourceMappingURL=Menace.astro_astro_type_script_index_0_lang.6iC_DQoq.js.map</script> <script>


document.addEventListener('alpine:init', () => {


  Alpine.data('menace', () => ({
    speed: 15,
    visible: false,
    train: true,
    size: 3,
    strikeSize: 3,
    session: '',
    firstPlayer: false,

    stats: {
      player: 0,
      machine: 0,
      draws: 0,
    },

    toggle(btn) {
      if (btn.getAttribute("aria-checked") === "true") {
        btn.setAttribute("aria-checked", "false");
        this.train = false;
      } else {
        btn.setAttribute("aria-checked", "true");
        this.train = true;
        this.play();
      }

    },

    restart() {
      this.reset({detail:[ this.size, this.strikeSize ]})
    },

    reset(e) {
      window.gameWorker.postMessage(['NEW_GAME', e.detail[0], e.detail[1] ])
      this.size = parseInt(e.detail[0])
      this.strikeSize = parseInt(e.detail[1])

      for (let i = 0; i < (this.size * this.size); i++) {
        this.getCell(i).classList.remove('draw')
        this.getCell(i).classList.remove('winner')
      }
      // this.paint()
      setTimeout(this.play.bind(this), this.speed)

    },

    getCell(i) {
      return document.querySelector(`#cell-${i}`)
    },


    game(e) {
      switch (e.detail[0]) {
        case "TRAIN_DATA":
          console.log(JSON.stringify(e.detail[1]))
          break;

        case "NEW_GAME":
          this.paint(e.detail[1].state)
          break;

        case "STATE":
          this.paint(e.detail[1].state)
          setTimeout(this.play.bind(this), this.speed)
          break;

        case "END":
          this.paint(e.detail[1].state)
          const data = e.detail[1]
          // setTimeout( this.reset.bind(this) , 500)
          // let data = await resp.json();
          this.stats = data.stats;
          updateChart(data.stats)
          // this.state = data.state;
          // this.paint()
          if (data.winner === "draw") {
            for (let i = 0; i < (this.size * this.size); i++) {
              this.getCell(i).classList.add('draw')
            }

          } else {
            for (let i of data.strike) {
              this.getCell(i).classList.add('winner')
            }
          }

          setTimeout(this.restart.bind(this), this.train ? this.speed : 1000)



      }
    },

    async init() {
      // this.play();
    },

    play() {
      if (this.train) {
        let cells = (Array.from(document.querySelectorAll('#grid div[data-empty="1"]')));
        let move = Math.floor(Math.random() * cells.length)
        // console.log(cells)
        cells[move] && cells[move].click()
      }
    },


    paint(state) {
      for (let i in state) {
        this.getCell(i).innerHTML = `<span class="cell-played cell-content-${state[i]}">${this.getSymbol(state[i])}</span>`
        this.getCell(i).dataset.empty = state[i] == 2 ? 1 : 0
      }
    },

    getSymbol(x) {
      switch (x) {
        case 0:
          return "O";

        case 1:
          return "X";

        case 2:
        default:
          return "";
      }
    },

    move() {
      let cell = parseInt(this.$el.dataset.cell) -1;
      window.gameWorker.postMessage(['MOVE', cell])
    },

    async test() {
      try {

          // body: JSON.stringify({
          //   move: cell,
          //   state: this.state,
          //   session: session
          // })

        if (resp.status === 200) {
          let data = await resp.json();
          this.state = data.state;
          this.moves = JSON.stringify(data.moves);

          this.$refs.moves.innerHTML = '';
          for (let m of data.moves) {
            let s = Array.from(this.state);
            // console.log( [ ...this.state, s ])
            s[ data.move ] = 2;
            s[ m[0] ] = 1;
            let c = this.thumbnail(s, 50);
            let p = document.createElement('div')
            p.innerHTML = m[1];

            this.$refs.moves.appendChild(c)
            this.$refs.moves.appendChild(p)
          }
          this.paint()
          this.play()

        }
      } catch (e) {
        console.log(e)
      }
    },



    newGame() {
      // for (let i = 0; i < this.size*this.size; i++) {
      //   let el = document.createElement('div');
      //   el.innerHTML = i;
      //   el.classList.add('cell')
      //   el.setAttribute('id',`cell-${i}`)
      //   el.addEventListener('click', (function(e) {
      //     console.log(e.target)
      //   }))
      //   this.$refs.grid.appendChild(el)
      // }
    },
    thumbnail(gridData, hw) {
      const size = Math.sqrt(gridData.length);
      const rows = size;
      const cols = size;


      const canvas = document.createElement('canvas')
      canvas.width = hw
      canvas.height= hw
      const ctx = canvas.getContext('2d');
      const cellSize = canvas.width / cols;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Set line properties to 3px thickness and #e5e7eb color
      ctx.strokeStyle = '#e5e7eb';
      ctx.lineWidth = 3;

      // Vertical lines (excluding outer borders)
      for (let i = 1; i < cols; i++) {
        ctx.beginPath();
        ctx.moveTo(i * cellSize, 0);
        ctx.lineTo(i * cellSize, canvas.height);
        ctx.stroke();
      }

      // Horizontal lines (excluding outer borders)
      for (let i = 1; i < rows; i++) {
        ctx.beginPath();
        ctx.moveTo(0, i * cellSize);
        ctx.lineTo(canvas.width, i * cellSize);
        ctx.stroke();
      }

      // Draw cell symbols based on values
      for (let row = 0; row < rows; row++) {
        for (let col = 0; col < cols; col++) {
          const index = row * cols + col;
          const value = gridData[index];

          // Calculate center position and size for the cell
          const x = col * cellSize + cellSize / 2;
          const y = row * cellSize + cellSize / 2;
          const symbolSize = cellSize * 0.6; // Size of symbol relative to cell

          if (value === 0) {
            // Draw a red O
            ctx.strokeStyle = 'red';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(x, y, symbolSize / 2, 0, Math.PI * 2);
            ctx.stroke();
          } else if (value === 1) {
            // Draw a blue X
            ctx.strokeStyle = 'blue';
            ctx.lineWidth = 2;

            // First line of X
            ctx.beginPath();
            ctx.moveTo(x - symbolSize / 2, y - symbolSize / 2);
            ctx.lineTo(x + symbolSize / 2, y + symbolSize / 2);
            ctx.stroke();

            // Second line of X
            ctx.beginPath();
            ctx.moveTo(x + symbolSize / 2, y - symbolSize / 2);
            ctx.lineTo(x - symbolSize / 2, y + symbolSize / 2);
            ctx.stroke();
          }
          // If value is 2, leave the cell empty
        }
      }

      return canvas;
    }


  }))
})
</script> <div class="container mt-10 py-20"> <div id="chart" style="height: 370px; width: 100%;"></div> </div> <script>

var dataPoints1 = [];
var dataPoints2 = [];
var dataPoints3 = [];

var chart = new CanvasJS.Chart("chart", {
  // zoomEnabled: true,
  theme: "light2", // "light1", "light2", "dark1", "dark2"
  title: {
    // text: "Share Value of Two Companies"
  },
  axisX: {
    // title: "chart updates every 3 secs"
  },
  toolTip: {
    shared: true
  },
  legend: {
    cursor:"pointer",
    verticalAlign: "top",
    fontSize: 22,
    fontColor: "dimGrey",
    itemclick : toggleDataSeries
  },
  data: [{
    type: "line",
    xValueType: "dateTime",
    showInLegend: true,
    name: "Player",
    color: "#fb2c36",
    dataPoints: dataPoints1
    },
    {
      type: "line",
      xValueType: "dateTime",
      showInLegend: true,
      name: "Machine" ,
      color: "#2b7fff",
      dataPoints: dataPoints2
  },    {
      type: "line",
      xValueType: "dateTime",
      showInLegend: true,
      name: "Draws" ,
      color: "#6a7282",
      dataPoints: dataPoints3
  }]
});

function toggleDataSeries(e) {
  if (typeof(e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
    e.dataSeries.visible = false;
  }
  else {
    e.dataSeries.visible = true;
  }
  chart.render();
}

function updateChart(stats) {
  let time = new Date().getTime()

  dataPoints1.push({
    x: time,
    y: parseInt(stats.player),
    color: "#fb2c36",
  });
  dataPoints2.push({
    x: time,
    y: parseInt(stats.machine),
    color: "#2b7fff",
  });
  dataPoints3.push({
    x: time,
    color: "#6a7282",
    y: parseInt(stats.draws)
  });

  chart.render();
}


</script>  </body></html>